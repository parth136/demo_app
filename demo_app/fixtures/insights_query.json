[
 {
  "chart": "jo5kbtuguo",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.0,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {},\n   \"operator\": {\n    \"label\": null,\n    \"value\": null\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": null,\n  \"table\": null\n }\n}",
  "last_execution": null,
  "limit": 500,
  "modified": "2024-08-10 16:10:47.653709",
  "name": "QRY-0354",
  "result_name": "jo5ltha8dh",
  "results_row_count": -1,
  "script": null,
  "script_log": null,
  "sql": "",
  "status": "Execution Successful",
  "tables": [],
  "title": "Query 0354",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "k38c6fuh1g",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.098,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 1,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Number of Customer\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"customer_name\",\n        \"table\": \"tabCustomer\"\n       }\n      }\n     ],\n     \"function\": \"count\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"count(`tabCustomer.customer_name`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Number of Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 1001,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 10:32:57.577996",
  "limit": 500,
  "modified": "2024-08-12 07:39:55.327341",
  "name": "QRY-0359",
  "result_name": "k38dtvn1uc",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT count(*) AS `Number of Customer`\n  FROM `tabCustomer` AS `tabCustomer`\n LIMIT 1001",
  "status": "Execution Successful",
  "tables": [],
  "title": "Number of Customer",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "vfshvnrh1h",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.086,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Referal Rate\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"left\": {\n      \"left\": {\n       \"arguments\": [\n        {\n         \"left\": {\n          \"type\": \"Column\",\n          \"value\": {\n           \"column\": \"lead_source\",\n           \"table\": \"tabCustomer\"\n          }\n         },\n         \"operator\": \"=\",\n         \"right\": {\n          \"type\": \"String\",\n          \"value\": \"Customer Referral\"\n         },\n         \"type\": \"BinaryExpression\"\n        }\n       ],\n       \"function\": \"count_if\",\n       \"type\": \"CallExpression\"\n      },\n      \"operator\": \"/\",\n      \"right\": {\n       \"arguments\": [\n        {\n         \"type\": \"Column\",\n         \"value\": {\n          \"column\": \"lead_source\",\n          \"table\": \"tabCustomer\"\n         }\n        }\n       ],\n       \"function\": \"count\",\n       \"type\": \"CallExpression\"\n      },\n      \"type\": \"BinaryExpression\"\n     },\n     \"operator\": \"*\",\n     \"right\": {\n      \"type\": \"Number\",\n      \"value\": 100\n     },\n     \"type\": \"BinaryExpression\"\n    },\n    \"raw\": \"(count_if(`tabCustomer.lead_source` = \\\"Customer Referral\\\")/ count(`tabCustomer.lead_source`)) * 100\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Referal Rate\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Decimal\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 10000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 10:32:57.579121",
  "limit": 500,
  "modified": "2024-08-12 07:47:21.826139",
  "name": "QRY-0361",
  "result_name": "vfsibm6a78",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT (sum(CASE WHEN (`tabCustomer`.lead_source = 'Customer Referral') THEN 1 ELSE 0 END) / count(*)) * 100 AS `Referal Rate`\n  FROM `tabCustomer` AS `tabCustomer`\n LIMIT 10000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Customer Referal Rate",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "viesatt8gm",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.0,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": null,\n  \"table\": null\n }\n}",
  "last_execution": null,
  "limit": 500,
  "modified": "2024-08-12 07:48:59.364435",
  "name": "QRY-0362",
  "result_name": "vietos4moe",
  "results_row_count": -1,
  "script": null,
  "script_log": null,
  "sql": "",
  "status": "Execution Successful",
  "tables": [],
  "title": "Query 0362",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "vm8k4r4bct",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.063,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"group by\",\n   \"alias\": \"Type Of Customer\",\n   \"column\": \"type_of_customer\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Type Of Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"customer_type\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 10:32:57.812025",
  "limit": 500,
  "modified": "2024-08-12 08:18:54.364964",
  "name": "QRY-0363",
  "result_name": "vm8kojvav4",
  "results_row_count": 5,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.type_of_customer AS `Type Of Customer`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.type_of_customer\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Types Of Customer",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "vrkaoarmb8",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.095,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"group by\",\n   \"alias\": \"Status\",\n   \"column\": \"status\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Status\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"count\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 10000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 10:32:58.112734",
  "limit": 500,
  "modified": "2024-08-12 08:10:16.011781",
  "name": "QRY-0364",
  "result_name": "vrkb7rtrak",
  "results_row_count": 5,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.status AS `Status`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.status\n LIMIT 10000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Status Of Customers",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "vv6l3gmudp",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.038,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Lead Source\",\n   \"column\": \"lead_source\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Lead Source\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"count\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 10:32:58.244268",
  "limit": 500,
  "modified": "2024-08-12 08:11:57.782668",
  "name": "QRY-0365",
  "result_name": "vv6lf068c2",
  "results_row_count": 4,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.lead_source AS `Lead Source`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.lead_source\n LIMIT 100",
  "status": "Execution Successful",
  "tables": [],
  "title": "Lead Source Wise Customer",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "09g1tvaslb",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.416,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customers\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"customer\",\n        \"table\": \"tabSales Invoice\"\n       }\n      }\n     ],\n     \"function\": \"distinct_count\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"sum\",\n   \"alias\": \"Qty\",\n   \"column\": \"qty\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Qty\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabSales Invoice Item\",\n   \"type\": \"Decimal\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refill Rate\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"left\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"qty\",\n         \"table\": \"tabSales Invoice Item\"\n        }\n       }\n      ],\n      \"function\": \"sum\",\n      \"type\": \"CallExpression\"\n     },\n     \"operator\": \"/\",\n     \"right\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"customer\",\n         \"table\": \"tabSales Invoice\"\n        }\n       }\n      ],\n      \"function\": \"distinct_count\",\n      \"type\": \"CallExpression\"\n     },\n     \"type\": \"BinaryExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`) / distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refill Rate\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Decimal\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"item_name\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"Refill\"\n      }\n     ],\n     \"function\": \"contains\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"contains(`tabSales Invoice Item.item_name`, \\\"Refill\\\") \"\n   },\n   \"operator\": {\n    \"label\": \"equals\",\n    \"value\": \"=\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"parent\",\n    \"label\": \"parent\",\n    \"table\": \"tabSales Invoice Item\",\n    \"value\": \"parent\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice Item\",\n    \"table\": \"tabSales Invoice Item\"\n   }\n  },\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"customer\",\n    \"label\": \"customer\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"customer\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabCustomer\",\n    \"value\": \"name\"\n   },\n   \"right_table\": {\n    \"label\": \"Customer\",\n    \"table\": \"tabCustomer\"\n   }\n  }\n ],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Sales Invoice\",\n  \"table\": \"tabSales Invoice\"\n }\n}",
  "last_execution": "2024-08-12 09:18:42.180362",
  "limit": 500,
  "modified": "2024-08-12 08:37:36.168984",
  "name": "QRY-0366",
  "result_name": "09g1hfk48c",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT count(DISTINCT `tabSales Invoice`.customer) AS `Customers`,\n       sum(`tabSales Invoice Item`.qty) AS `Qty`,\n       sum(`tabSales Invoice Item`.qty) / count(DISTINCT `tabSales Invoice`.customer) AS `Refill Rate`\n  FROM `tabSales Invoice` AS `tabSales Invoice`\n INNER JOIN `tabSales Invoice Item` AS `tabSales Invoice Item`\n    ON `tabSales Invoice`.name = `tabSales Invoice Item`.parent\n INNER JOIN `tabCustomer` AS `tabCustomer`\n    ON `tabSales Invoice`.customer = `tabCustomer`.name\n WHERE `tabSales Invoice Item`.item_name LIKE '%%Refill%%'\n LIMIT 100",
  "status": "Execution Successful",
  "tables": [],
  "title": "Refill Rate Metrics",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "0k40d3att9",
  "columns": [],
  "data_source": null,
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.0,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": null,\n  \"table\": null\n }\n}",
  "last_execution": null,
  "limit": 500,
  "modified": "2024-08-12 08:46:15.096394",
  "name": "QRY-0367",
  "result_name": "0k40v9sc3m",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": null,
  "status": "Execution Successful",
  "tables": [],
  "title": "Query 0367",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "oh62cn8ca8",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.115,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Referral Company\",\n   \"column\": \"referral_company\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Referral Company\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"count\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": null,\n    \"alias\": \"Referral Company\",\n    \"column\": \"referral_company\",\n    \"expression\": {},\n    \"format\": null,\n    \"granularity\": null,\n    \"label\": \"Referral Company\",\n    \"meta\": null,\n    \"order\": null,\n    \"table\": \"tabCustomer\",\n    \"type\": \"String\"\n   },\n   \"expression\": {},\n   \"operator\": {\n    \"label\": \"is set\",\n    \"value\": \"is_set\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 09:59:17.020494",
  "limit": 500,
  "modified": "2024-06-12 12:59:30.485515",
  "name": "QRY-0006",
  "result_name": "16hcsmvj7q",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.referral_company AS `Referral Company`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n WHERE `tabCustomer`.referral_company IS NOT NULL\n GROUP BY `tabCustomer`.referral_company\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Franchise Wise Customers",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "rclfdvds5p",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.171,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 0,
  "is_native_query": 1,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{}",
  "last_execution": "2024-08-12 10:38:57.497369",
  "limit": 500,
  "modified": "2024-06-14 10:22:44.394074",
  "name": "QRY-0029",
  "result_name": "1kkltescjo",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT COUNT(DISTINCT CASE WHEN tw.customer IS NOT NULL THEN tw.customer END) AS \"Customers Who Bought This Two Week & Last Two Week\",\n       COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL THEN lw.customer END) AS \"Customers Who Bought Last Two Week Only\",\n       CONCAT(ROUND((COUNT(DISTINCT CASE WHEN tw.customer IS NOT NULL THEN tw.customer END) / NULLIF(COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL THEN lw.customer END), 0)) * 100, 2), '%') AS \"Retention Rate\"\n  FROM (\n        SELECT DISTINCT customer\n          FROM `tabSales Invoice`\n         WHERE posting_date >= CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 21) DAY\n           AND posting_date < CURDATE() - INTERVAL WEEKDAY(CURDATE()) + 8 DAY\n       ) AS lw\n  LEFT JOIN (\n        SELECT DISTINCT customer\n          FROM `tabSales Invoice`\n         WHERE posting_date >= CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 7) DAY\n           AND posting_date < CURDATE() + INTERVAL (6 - WEEKDAY(CURDATE())) DAY\n       ) AS tw\n    ON lw.customer = tw.customer",
  "status": "Execution Successful",
  "tables": [],
  "title": "Global Retention Rate SQL Query(Weekly)",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "oj1s81e9g6",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.066,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Franchise Name\",\n   \"column\": \"franchise_name\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Franchise Name\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"count\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": null,\n    \"alias\": \"Franchise Name\",\n    \"column\": \"franchise_name\",\n    \"expression\": {},\n    \"format\": null,\n    \"granularity\": null,\n    \"label\": \"Franchise Name\",\n    \"meta\": null,\n    \"order\": null,\n    \"table\": \"tabCustomer\",\n    \"type\": \"String\"\n   },\n   \"expression\": {},\n   \"operator\": {\n    \"label\": \"is set\",\n    \"value\": \"is_set\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 10:44:01.609846",
  "limit": 500,
  "modified": "2024-08-12 10:29:40.095024",
  "name": "QRY-0007",
  "result_name": "2gkuoid023",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.franchise_name AS `Franchise Name`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n WHERE `tabCustomer`.franchise_name IS NOT NULL\n GROUP BY `tabCustomer`.franchise_name\n LIMIT 100000",
  "status": "Execution Failed",
  "tables": [],
  "title": "Franchise(site) Wise Customers",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "mlltkt3lft",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.0,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"group by\",\n   \"alias\": \"SKUs\",\n   \"column\": \"item_name\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"SKUs\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabSales Invoice Item\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Type Of Customer\",\n   \"column\": \"type_of_customer\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Type Of Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Week\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"String\",\n       \"value\": \"CONCAT(DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (2 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY),' - ',DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (8 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY))\"\n      }\n     ],\n     \"function\": \"sql\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"sql(\\\"CONCAT(DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (2 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY),' - ',DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (8 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY))\\\")\"\n   },\n   \"format\": {},\n   \"granularity\": \"Day\",\n   \"label\": \"Week\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Datetime\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"item_name\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"Refill\"\n      }\n     ],\n     \"function\": \"contains\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"contains(`tabSales Invoice Item.item_name` , \\\"Refill\\\")\"\n   },\n   \"operator\": {\n    \"label\": \"equals\",\n    \"value\": \"=\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"parent\",\n    \"label\": \"parent\",\n    \"table\": \"tabSales Invoice Item\",\n    \"value\": \"parent\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice Item\",\n    \"table\": \"tabSales Invoice Item\"\n   }\n  },\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"customer\",\n    \"label\": \"customer\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"customer\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabCustomer\",\n    \"value\": \"name\"\n   },\n   \"right_table\": {\n    \"label\": \"Customer\",\n    \"table\": \"tabCustomer\"\n   }\n  }\n ],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Sales Invoice\",\n  \"table\": \"tabSales Invoice\"\n }\n}",
  "last_execution": null,
  "limit": 500,
  "modified": "2024-06-13 16:39:55.665268",
  "name": "QRY-0023",
  "result_name": "2p1qntm4v7",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabSales Invoice Item`.item_name AS `SKUs`,\n       `tabCustomer`.type_of_customer AS `Type Of Customer`,\n       date_format(CONCAT(DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (2 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY),' - ',DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (8 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY)), '%%Y-%%m-%%d 00:00') AS `Week`\n  FROM `tabSales Invoice` AS `tabSales Invoice`\n INNER JOIN `tabSales Invoice Item` AS `tabSales Invoice Item`\n    ON `tabSales Invoice`.name = `tabSales Invoice Item`.parent\n INNER JOIN `tabCustomer` AS `tabCustomer`\n    ON `tabSales Invoice`.customer = `tabCustomer`.name\n WHERE `tabSales Invoice Item`.item_name LIKE '%%Refill%%'\n GROUP BY `tabSales Invoice Item`.item_name,\n          `tabCustomer`.type_of_customer,\n          date_format(CONCAT(DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (2 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY),' - ',DATE_ADD(`tabSales Invoice`.posting_date, INTERVAL (8 - DAYOFWEEK(`tabSales Invoice`.posting_date)) DAY)), '%%Y-%%m-%%d 00:00')\n LIMIT 100",
  "status": "Execution Successful",
  "tables": [],
  "title": "Average of refill SKUs per Customer Type(Weekly)",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "obg6avvst5",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.111,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Status\",\n   \"column\": \"status\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Status\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"count\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 09:59:16.701922",
  "limit": 500,
  "modified": "2024-06-12 12:59:47.035347",
  "name": "QRY-0004",
  "result_name": "16h9mhv7dg",
  "results_row_count": 5,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.status AS `Status`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.status\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Status of Customers",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "ndh0cf4gle",
  "columns": [],
  "data_source": "Query Store",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.019,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Retention Rate Visual Query Franchise Wise(Weekly)\",\n  \"table\": \"QRY-0025\"\n }\n}",
  "last_execution": "2024-06-24 15:44:41.917824",
  "limit": 500,
  "modified": "2024-06-24 13:53:01.719733",
  "name": "QRY-0040",
  "result_name": "2p1qvp1upp",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT \"QRY-0025\".*\n  FROM \"QRY-0025\" AS \"QRY-0025\"\n LIMIT 100\nOFFSET 0",
  "status": "Execution Successful",
  "tables": [],
  "title": "Query 0040",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "jfoumv2fq5",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.093,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"group by\",\n   \"alias\": \"Franchise\",\n   \"column\": \"company\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Franchise\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabSales Invoice\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Item Code Name\",\n   \"column\": \"item_code_name\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Item Code Name\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabSales Invoice Item\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Type Of Customer\",\n   \"column\": \"type_of_customer\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Type Of Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refills\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"qty\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      }\n     ],\n     \"function\": \"sum\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refills\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customer\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"customer\",\n        \"table\": \"tabSales Invoice\"\n       }\n      }\n     ],\n     \"function\": \"distinct_count\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refill Rate\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"left\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"qty\",\n         \"table\": \"tabSales Invoice Item\"\n        }\n       }\n      ],\n      \"function\": \"sum\",\n      \"type\": \"CallExpression\"\n     },\n     \"operator\": \"/\",\n     \"right\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"customer\",\n         \"table\": \"tabSales Invoice\"\n        }\n       }\n      ],\n      \"function\": \"distinct_count\",\n      \"type\": \"CallExpression\"\n     },\n     \"type\": \"BinaryExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`) / distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refill Rate\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Decimal\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"item_name\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"Refill\"\n      }\n     ],\n     \"function\": \"contains\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"contains(`tabSales Invoice Item.item_name` , \\\"Refill\\\")\"\n   },\n   \"operator\": {\n    \"label\": \"equals\",\n    \"value\": \"=\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"parent\",\n    \"label\": \"parent\",\n    \"table\": \"tabSales Invoice Item\",\n    \"value\": \"parent\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice Item\",\n    \"table\": \"tabSales Invoice Item\"\n   }\n  },\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"customer\",\n    \"label\": \"customer\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"customer\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabCustomer\",\n    \"value\": \"name\"\n   },\n   \"right_table\": {\n    \"label\": \"Customer\",\n    \"table\": \"tabCustomer\"\n   }\n  }\n ],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Sales Invoice\",\n  \"table\": \"tabSales Invoice\"\n }\n}",
  "last_execution": "2024-08-12 11:08:29.276153",
  "limit": 500,
  "modified": "2024-08-12 09:59:28.760650",
  "name": "QRY-0020",
  "result_name": "1jn70d80pa",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabSales Invoice`.company AS `Franchise`,\n       `tabSales Invoice Item`.item_code_name AS `Item Code Name`,\n       `tabCustomer`.type_of_customer AS `Type Of Customer`,\n       sum(`tabSales Invoice Item`.qty) AS `Refills`,\n       count(DISTINCT `tabSales Invoice`.customer) AS `Customer`,\n       sum(`tabSales Invoice Item`.qty) / count(DISTINCT `tabSales Invoice`.customer) AS `Refill Rate`\n  FROM `tabSales Invoice` AS `tabSales Invoice`\n INNER JOIN `tabSales Invoice Item` AS `tabSales Invoice Item`\n    ON `tabSales Invoice`.name = `tabSales Invoice Item`.parent\n INNER JOIN `tabCustomer` AS `tabCustomer`\n    ON `tabSales Invoice`.customer = `tabCustomer`.name\n WHERE `tabSales Invoice Item`.item_name LIKE '%%Refill%%'\n GROUP BY `tabSales Invoice`.company,\n          `tabSales Invoice Item`.item_code_name,\n          `tabCustomer`.type_of_customer\n LIMIT 100",
  "status": "Execution Failed",
  "tables": [],
  "title": "Franchise SKU Type\u00a0 of Customer Wise Refill Rate",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "odhromoi41",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.083,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Lead Source\",\n   \"column\": \"lead_source\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Lead Source\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"count\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 09:59:16.739353",
  "limit": 500,
  "modified": "2024-06-12 12:59:37.426853",
  "name": "QRY-0005",
  "result_name": "16haopoieq",
  "results_row_count": 4,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.lead_source AS `Lead Source`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.lead_source\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Lead Source\u00a0 Wise Customers",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "o8tt3e2mjv",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.081,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Type Of Customer\",\n   \"column\": \"type_of_customer\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Type Of Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"customer_type\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 09:59:16.342338",
  "limit": 500,
  "modified": "2024-06-12 11:30:38.990589",
  "name": "QRY-0003",
  "result_name": "16h6io36oj",
  "results_row_count": 5,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.type_of_customer AS `Type Of Customer`,\n       count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.type_of_customer\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Type of Customers",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "opsq3bka6r",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.09,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 0,
  "is_native_query": 1,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{}",
  "last_execution": "2024-08-12 10:38:49.200199",
  "limit": 500,
  "modified": "2024-06-19 16:02:17.717726",
  "name": "QRY-0026",
  "result_name": "1kfsk864hj",
  "results_row_count": 2,
  "script": null,
  "script_log": null,
  "sql": "SELECT lm.company,\n       COUNT(DISTINCT CASE WHEN cm.customer IS NOT NULL THEN cm.customer END) AS \"Customers Who Bought This Month & Last Month\",\n       COUNT(DISTINCT CASE WHEN lm.customer IS NOT NULL THEN lm.customer END) AS \"Customers Who Bought Last Month Only\",\n       CONCAT(ROUND((COUNT(DISTINCT CASE WHEN cm.customer IS NOT NULL THEN cm.customer END) / NULLIF(COUNT(DISTINCT CASE WHEN lm.customer IS NOT NULL THEN lm.customer END), 0)) * 100, 2), '%') AS \"Retention Rate\",\n       CONCAT(DATE_FORMAT(CURDATE() - INTERVAL 1 MONTH, '%Y-%m-01'), ' to ', DATE_FORMAT(CURDATE(), '%Y-%m-01')) AS \"Last Month Date Range\",\n       CONCAT(DATE_FORMAT(CURDATE(), '%Y-%m-01'), ' to ', DATE_FORMAT(CURDATE() + INTERVAL 1 MONTH, '%Y-%m-01')) AS \"This Month Date Range\"\n  FROM (\n        SELECT DISTINCT customer,\n               company\n          FROM `tabSales Invoice`\n         WHERE posting_date >= DATE_FORMAT(CURDATE() - INTERVAL 1 MONTH, '%Y-%m-01')\n           AND posting_date < DATE_FORMAT(CURDATE(), '%Y-%m-01')\n       ) AS lm\n  LEFT JOIN (\n        SELECT DISTINCT customer,\n               company\n          FROM `tabSales Invoice`\n         WHERE posting_date >= DATE_FORMAT(CURDATE(), '%Y-%m-01')\n           AND posting_date < DATE_FORMAT(CURDATE() + INTERVAL 1 MONTH, '%Y-%m-01')\n       ) AS cm\n    ON lm.customer = cm.customer\n GROUP BY lm.company",
  "status": "Execution Successful",
  "tables": [],
  "title": "Retention Rate SQL Query Franchise Wise",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "m7od054nik",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.304,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {},\n    \"raw\": \"\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"String\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabCustomer\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Customer\",\n    \"table\": \"tabCustomer\"\n   },\n   \"right_column\": {\n    \"column\": \"customer\",\n    \"label\": \"customer\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"customer\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   }\n  },\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"parent\",\n    \"label\": \"parent\",\n    \"table\": \"tabSales Invoice Item\",\n    \"value\": \"parent\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice Item\",\n    \"table\": \"tabSales Invoice Item\"\n   }\n  }\n ],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 10:36:39.571951",
  "limit": 500,
  "modified": "2024-06-24 13:39:13.791834",
  "name": "QRY-0034",
  "result_name": "2kofjaqo9c",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.*\n  FROM `tabCustomer` AS `tabCustomer`\n INNER JOIN `tabSales Invoice` AS `tabSales Invoice`\n    ON `tabCustomer`.name = `tabSales Invoice`.customer\n INNER JOIN `tabSales Invoice Item` AS `tabSales Invoice Item`\n    ON `tabSales Invoice`.name = `tabSales Invoice Item`.parent\n LIMIT 100",
  "status": "Execution Successful",
  "tables": [],
  "title": "Retention Rate Visual Query Franchise Wise(Monthly)",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "o2n0tmltaf",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.07,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"count\",\n   \"alias\": \"Total Customers\",\n   \"column\": \"count\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Total Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 09:59:16.368033",
  "limit": 500,
  "modified": "2024-06-12 12:59:56.484044",
  "name": "QRY-0001",
  "result_name": "16h6774vb0",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT count(*) AS `Total Customers`\n  FROM `tabCustomer` AS `tabCustomer`\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Total Customer",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "vebekpk0ni",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.064,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"group by\",\n   \"alias\": \"Franchise Name\",\n   \"column\": \"franchise_name\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Franchise Name\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customer With No Referral Company\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"left\": {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"referral_company\",\n         \"table\": \"tabCustomer\"\n        }\n       },\n       \"operator\": \"=\",\n       \"right\": {\n        \"type\": \"String\",\n        \"value\": \"\"\n       },\n       \"type\": \"BinaryExpression\"\n      }\n     ],\n     \"function\": \"count_if\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"count_if(`tabCustomer.referral_company` = \\\"\\\")\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customer With No Referral Company\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 10000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-06-28 13:27:55.597103",
  "limit": 500,
  "modified": "2024-06-28 13:27:55.692524",
  "name": "QRY-0042",
  "result_name": "2p1qel7qnv",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.franchise_name AS `Franchise Name`,\n       sum(CASE WHEN (`tabCustomer`.referral_company = '') THEN 1 ELSE 0 END) AS `Customer With No Referral Company`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.franchise_name\n LIMIT 10000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Customer With No Referral Company\u00a0",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "j4able2ekr",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.985,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"group by\",\n   \"alias\": \"Franchise\",\n   \"column\": \"company\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Franchise\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabSales Invoice\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Type Of Customer\",\n   \"column\": \"type_of_customer\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Type Of Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refill\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"qty\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      }\n     ],\n     \"function\": \"sum\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refill\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customers\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"customer\",\n        \"table\": \"tabSales Invoice\"\n       }\n      }\n     ],\n     \"function\": \"distinct_count\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refill Rate\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"left\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"qty\",\n         \"table\": \"tabSales Invoice Item\"\n        }\n       }\n      ],\n      \"function\": \"sum\",\n      \"type\": \"CallExpression\"\n     },\n     \"operator\": \"/\",\n     \"right\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"customer\",\n         \"table\": \"tabSales Invoice\"\n        }\n       }\n      ],\n      \"function\": \"distinct_count\",\n      \"type\": \"CallExpression\"\n     },\n     \"type\": \"BinaryExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`) / distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refill Rate\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Decimal\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"item_name\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"Refill\"\n      }\n     ],\n     \"function\": \"contains\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"contains(`tabSales Invoice Item.item_name`, \\\"Refill\\\")\"\n   },\n   \"operator\": {\n    \"label\": \"equals\",\n    \"value\": \"=\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"parent\",\n    \"label\": \"parent\",\n    \"table\": \"tabSales Invoice Item\",\n    \"value\": \"parent\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice Item\",\n    \"table\": \"tabSales Invoice Item\"\n   }\n  },\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"customer\",\n    \"label\": \"customer\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"customer\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabCustomer\",\n    \"value\": \"name\"\n   },\n   \"right_table\": {\n    \"label\": \"Customer\",\n    \"table\": \"tabCustomer\"\n   }\n  }\n ],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Sales Invoice\",\n  \"table\": \"tabSales Invoice\"\n }\n}",
  "last_execution": "2024-08-12 09:59:29.640989",
  "limit": 500,
  "modified": "2024-06-19 18:36:15.584824",
  "name": "QRY-0019",
  "result_name": "16epoqieir",
  "results_row_count": 9,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabSales Invoice`.company AS `Franchise`,\n       `tabCustomer`.type_of_customer AS `Type Of Customer`,\n       sum(`tabSales Invoice Item`.qty) AS `Refill`,\n       count(DISTINCT `tabSales Invoice`.customer) AS `Customers`,\n       sum(`tabSales Invoice Item`.qty) / count(DISTINCT `tabSales Invoice`.customer) AS `Refill Rate`\n  FROM `tabSales Invoice` AS `tabSales Invoice`\n INNER JOIN `tabSales Invoice Item` AS `tabSales Invoice Item`\n    ON `tabSales Invoice`.name = `tabSales Invoice Item`.parent\n INNER JOIN `tabCustomer` AS `tabCustomer`\n    ON `tabSales Invoice`.customer = `tabCustomer`.name\n WHERE `tabSales Invoice Item`.item_name LIKE '%%Refill%%'\n GROUP BY `tabSales Invoice`.company,\n          `tabCustomer`.type_of_customer\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Franchise Type of Customer Wise Refill Rate",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "hi6h1kvrc9",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.488,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"group by\",\n   \"alias\": \"SKUs\",\n   \"column\": \"item_name\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"SKUs\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabSales Invoice Item\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Type Of Customer\",\n   \"column\": \"type_of_customer\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Type Of Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refills\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"qty\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      }\n     ],\n     \"function\": \"sum\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refills\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customer\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"customer\",\n        \"table\": \"tabSales Invoice\"\n       }\n      }\n     ],\n     \"function\": \"distinct_count\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customer\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refill Rate\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"left\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"qty\",\n         \"table\": \"tabSales Invoice Item\"\n        }\n       }\n      ],\n      \"function\": \"sum\",\n      \"type\": \"CallExpression\"\n     },\n     \"operator\": \"/\",\n     \"right\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"customer\",\n         \"table\": \"tabSales Invoice\"\n        }\n       }\n      ],\n      \"function\": \"distinct_count\",\n      \"type\": \"CallExpression\"\n     },\n     \"type\": \"BinaryExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`) / distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refill Rate\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Decimal\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {},\n    \"raw\": \"\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"String\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"item_name\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"Refill\"\n      }\n     ],\n     \"function\": \"contains\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"contains(`tabSales Invoice Item.item_name` , \\\"Refill\\\")\"\n   },\n   \"operator\": {\n    \"label\": \"equals\",\n    \"value\": \"=\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"parent\",\n    \"label\": \"parent\",\n    \"table\": \"tabSales Invoice Item\",\n    \"value\": \"parent\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice Item\",\n    \"table\": \"tabSales Invoice Item\"\n   }\n  },\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"customer\",\n    \"label\": \"customer\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"customer\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabCustomer\",\n    \"value\": \"name\"\n   },\n   \"right_table\": {\n    \"label\": \"Customer\",\n    \"table\": \"tabCustomer\"\n   }\n  }\n ],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Sales Invoice\",\n  \"table\": \"tabSales Invoice\"\n }\n}",
  "last_execution": "2024-08-12 10:38:27.565531",
  "limit": 500,
  "modified": "2024-06-13 14:37:42.397226",
  "name": "QRY-0017",
  "result_name": "16cfs4oiqq",
  "results_row_count": 25,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabSales Invoice Item`.item_name AS `SKUs`,\n       `tabCustomer`.type_of_customer AS `Type Of Customer`,\n       sum(`tabSales Invoice Item`.qty) AS `Refills`,\n       count(DISTINCT `tabSales Invoice`.customer) AS `Customer`,\n       sum(`tabSales Invoice Item`.qty) / count(DISTINCT `tabSales Invoice`.customer) AS `Refill Rate`\n  FROM `tabSales Invoice` AS `tabSales Invoice`\n INNER JOIN `tabSales Invoice Item` AS `tabSales Invoice Item`\n    ON `tabSales Invoice`.name = `tabSales Invoice Item`.parent\n INNER JOIN `tabCustomer` AS `tabCustomer`\n    ON `tabSales Invoice`.customer = `tabCustomer`.name\n WHERE `tabSales Invoice Item`.item_name LIKE '%%Refill%%'\n GROUP BY `tabSales Invoice Item`.item_name,\n          `tabCustomer`.type_of_customer\n LIMIT 100",
  "status": "Execution Successful",
  "tables": [],
  "title": "Average of refill SKUs per Customer Type",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "p5pu971np2",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.085,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Referral Rate\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"left\": {\n      \"left\": {\n       \"arguments\": [\n        {\n         \"left\": {\n          \"type\": \"Column\",\n          \"value\": {\n           \"column\": \"lead_source\",\n           \"table\": \"tabCustomer\"\n          }\n         },\n         \"operator\": \"=\",\n         \"right\": {\n          \"type\": \"String\",\n          \"value\": \"Customer Referral\"\n         },\n         \"type\": \"BinaryExpression\"\n        }\n       ],\n       \"function\": \"count_if\",\n       \"type\": \"CallExpression\"\n      },\n      \"operator\": \"/\",\n      \"right\": {\n       \"arguments\": [\n        {\n         \"type\": \"Column\",\n         \"value\": {\n          \"column\": \"lead_source\",\n          \"table\": \"tabCustomer\"\n         }\n        }\n       ],\n       \"function\": \"count\",\n       \"type\": \"CallExpression\"\n      },\n      \"type\": \"BinaryExpression\"\n     },\n     \"operator\": \"*\",\n     \"right\": {\n      \"type\": \"Number\",\n      \"value\": 100\n     },\n     \"type\": \"BinaryExpression\"\n    },\n    \"raw\": \"(count_if(`tabCustomer.lead_source` = \\\"Customer Referral\\\")/ count(`tabCustomer.lead_source`)) * 100\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Referral Rate\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Decimal\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {},\n   \"operator\": {\n    \"label\": null,\n    \"value\": null\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-08-12 09:59:16.284301",
  "limit": 500,
  "modified": "2024-08-12 10:13:52.720914",
  "name": "QRY-0008",
  "result_name": "16h52jlggc",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT (sum(CASE WHEN (`tabCustomer`.lead_source = 'Customer Referral') THEN 1 ELSE 0 END) / count(*)) * 100 AS `Referral Rate`\n  FROM `tabCustomer` AS `tabCustomer`\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Customer Referral Rate",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "0lfe33trkm",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.457,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customers\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"customer\",\n        \"table\": \"tabSales Invoice\"\n       }\n      }\n     ],\n     \"function\": \"distinct_count\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customers\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Integer\"\n  },\n  {\n   \"aggregation\": \"sum\",\n   \"alias\": \"Refills\",\n   \"column\": \"qty\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refills\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabSales Invoice Item\",\n   \"type\": \"Decimal\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Refill Rate\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"left\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"qty\",\n         \"table\": \"tabSales Invoice Item\"\n        }\n       }\n      ],\n      \"function\": \"sum\",\n      \"type\": \"CallExpression\"\n     },\n     \"operator\": \"/\",\n     \"right\": {\n      \"arguments\": [\n       {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"customer\",\n         \"table\": \"tabSales Invoice\"\n        }\n       }\n      ],\n      \"function\": \"distinct_count\",\n      \"type\": \"CallExpression\"\n     },\n     \"type\": \"BinaryExpression\"\n    },\n    \"raw\": \"sum(`tabSales Invoice Item.qty`) / distinct_count(`tabSales Invoice.customer`)\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Refill Rate\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"Decimal\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {},\n    \"raw\": \"\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"String\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [\n  {\n   \"column\": {\n    \"aggregation\": \"\",\n    \"alias\": \"\",\n    \"column\": \"\",\n    \"expression\": {},\n    \"format\": {},\n    \"granularity\": \"\",\n    \"label\": \"\",\n    \"meta\": null,\n    \"order\": \"\",\n    \"table\": \"\",\n    \"type\": \"String\"\n   },\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"item_name\",\n        \"table\": \"tabSales Invoice Item\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"Refill\"\n      }\n     ],\n     \"function\": \"contains\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"contains(`tabSales Invoice Item.item_name`, \\\"Refill\\\") \"\n   },\n   \"operator\": {\n    \"label\": \"equals\",\n    \"value\": \"=\"\n   },\n   \"value\": {\n    \"label\": null,\n    \"value\": null\n   }\n  }\n ],\n \"joins\": [\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"name\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"parent\",\n    \"label\": \"parent\",\n    \"table\": \"tabSales Invoice Item\",\n    \"value\": \"parent\"\n   },\n   \"right_table\": {\n    \"label\": \"Sales Invoice Item\",\n    \"table\": \"tabSales Invoice Item\"\n   }\n  },\n  {\n   \"join_type\": {\n    \"label\": \"Inner Join\",\n    \"value\": \"inner\"\n   },\n   \"left_column\": {\n    \"column\": \"customer\",\n    \"label\": \"customer\",\n    \"table\": \"tabSales Invoice\",\n    \"value\": \"customer\"\n   },\n   \"left_table\": {\n    \"label\": \"Sales Invoice\",\n    \"table\": \"tabSales Invoice\"\n   },\n   \"right_column\": {\n    \"column\": \"name\",\n    \"label\": \"name\",\n    \"table\": \"tabCustomer\",\n    \"value\": \"name\"\n   },\n   \"right_table\": {\n    \"label\": \"Customer\",\n    \"table\": \"tabCustomer\"\n   }\n  }\n ],\n \"limit\": 100000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Sales Invoice\",\n  \"table\": \"tabSales Invoice\"\n }\n}",
  "last_execution": "2024-08-12 10:38:27.548799",
  "limit": 500,
  "modified": "2024-06-13 14:34:57.667010",
  "name": "QRY-0016",
  "result_name": "16ccce1l8v",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT count(DISTINCT `tabSales Invoice`.customer) AS `Customers`,\n       sum(`tabSales Invoice Item`.qty) AS `Refills`,\n       sum(`tabSales Invoice Item`.qty) / count(DISTINCT `tabSales Invoice`.customer) AS `Refill Rate`\n  FROM `tabSales Invoice` AS `tabSales Invoice`\n INNER JOIN `tabSales Invoice Item` AS `tabSales Invoice Item`\n    ON `tabSales Invoice`.name = `tabSales Invoice Item`.parent\n INNER JOIN `tabCustomer` AS `tabCustomer`\n    ON `tabSales Invoice`.customer = `tabCustomer`.name\n WHERE `tabSales Invoice Item`.item_name LIKE '%%Refill%%'\n LIMIT 100000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Global Refill Rate Metrics",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "g55cfn2q76",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.189,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 0,
  "is_native_query": 1,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{}",
  "last_execution": "2024-08-12 10:38:54.414525",
  "limit": 500,
  "modified": "2024-06-14 14:16:29.420486",
  "name": "QRY-0030",
  "result_name": "1kklj4el59",
  "results_row_count": 5,
  "script": null,
  "script_log": null,
  "sql": "SELECT c.referral_company AS \"Franchise\",\n       c.type_of_customer AS \"Type of Customer\",\n       CONCAT(DATE_FORMAT(CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 21) DAY, '%d-%m-%Y'), ' to ', DATE_FORMAT(CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 8) DAY, '%d-%m-%Y')) AS \"Last Two Week\",\n       CONCAT(DATE_FORMAT(CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 7) DAY, '%d-%m-%Y'), ' to ', DATE_FORMAT(CURDATE() + INTERVAL (6 - WEEKDAY(CURDATE())) DAY, '%d-%m-%Y')) AS \"This Two Week\",\n       COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL AND tw.customer IS NOT NULL THEN lw.customer END) AS \"Customers Who Bought This Week & Last Week\",\n       COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL THEN lw.customer END) AS \"Customers Who Bought Last Week Only\",\n       CONCAT(ROUND(COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL AND tw.customer IS NOT NULL THEN lw.customer END) / NULLIF(COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL THEN lw.customer END), 0) * 100, 2), '%') AS \"Retention Rate\"\n  FROM (\n        SELECT DISTINCT name,\n               type_of_customer,\n               referral_company\n          FROM `tabCustomer`\n       ) AS c\n  LEFT JOIN (\n        SELECT DISTINCT customer,\n               company\n          FROM `tabSales Invoice`\n         WHERE posting_date >= CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 21) DAY\n           AND posting_date < CURDATE() - INTERVAL WEEKDAY(CURDATE()) + 8 DAY\n       ) AS lw\n    ON c.name = lw.customer\n  LEFT JOIN (\n        SELECT DISTINCT customer,\n               company\n          FROM `tabSales Invoice`\n         WHERE posting_date >= CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 7) DAY\n           AND posting_date < CURDATE() + INTERVAL (6 - WEEKDAY(CURDATE())) DAY\n       ) AS tw\n    ON c.name = tw.customer\n GROUP BY c.referral_company,\n          c.type_of_customer",
  "status": "Execution Successful",
  "tables": [],
  "title": "Retention Rate SQL Query Franchise\u00a0 & Type of Customer Wise(Weekly)",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "vjdg82pdjt",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.05,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 0,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Franchise Name\",\n   \"column\": \"franchise_name\",\n   \"expression\": {},\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Franchise Name\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"tabCustomer\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customer Id\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"left\": {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"referral_company\",\n         \"table\": \"tabCustomer\"\n        }\n       },\n       \"operator\": \"=\",\n       \"right\": {\n        \"type\": \"String\",\n        \"value\": \"\"\n       },\n       \"type\": \"BinaryExpression\"\n      },\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"franchise_doctype_id\",\n        \"table\": \"tabCustomer\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"\"\n      }\n     ],\n     \"function\": \"case\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"case(`tabCustomer.referral_company` = \\\"\\\" , `tabCustomer.franchise_doctype_id`, \\\"\\\")\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customer Id\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"String\"\n  },\n  {\n   \"aggregation\": \"\",\n   \"alias\": \"Customer Name\",\n   \"column\": \"\",\n   \"expression\": {\n    \"ast\": {\n     \"arguments\": [\n      {\n       \"left\": {\n        \"type\": \"Column\",\n        \"value\": {\n         \"column\": \"referral_company\",\n         \"table\": \"tabCustomer\"\n        }\n       },\n       \"operator\": \"=\",\n       \"right\": {\n        \"type\": \"String\",\n        \"value\": \"\"\n       },\n       \"type\": \"BinaryExpression\"\n      },\n      {\n       \"type\": \"Column\",\n       \"value\": {\n        \"column\": \"customer_name\",\n        \"table\": \"tabCustomer\"\n       }\n      },\n      {\n       \"type\": \"String\",\n       \"value\": \"\"\n      }\n     ],\n     \"function\": \"case\",\n     \"type\": \"CallExpression\"\n    },\n    \"raw\": \"case(`tabCustomer.referral_company` = \\\"\\\" , `tabCustomer.customer_name`, \\\"\\\")\"\n   },\n   \"format\": {},\n   \"granularity\": \"\",\n   \"label\": \"Customer Name\",\n   \"meta\": null,\n   \"order\": \"\",\n   \"table\": \"\",\n   \"type\": \"String\"\n  }\n ],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 10000,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": \"Customer\",\n  \"table\": \"tabCustomer\"\n }\n}",
  "last_execution": "2024-06-28 13:38:04.070393",
  "limit": 500,
  "modified": "2024-06-28 13:38:04.191885",
  "name": "QRY-0043",
  "result_name": "2jnqbclt6s",
  "results_row_count": 0,
  "script": null,
  "script_log": null,
  "sql": "SELECT `tabCustomer`.franchise_name AS `Franchise Name`,\n       CASE WHEN (`tabCustomer`.referral_company = '') THEN `tabCustomer`.franchise_doctype_id\n            ELSE ''\n             END AS `Customer Id`,\n       CASE WHEN (`tabCustomer`.referral_company = '') THEN `tabCustomer`.customer_name\n            ELSE ''\n             END AS `Customer Name`\n  FROM `tabCustomer` AS `tabCustomer`\n GROUP BY `tabCustomer`.franchise_name,\n          CASE WHEN (`tabCustomer`.referral_company = '') THEN `tabCustomer`.franchise_doctype_id\n               ELSE ''\n                END,\n          CASE WHEN (`tabCustomer`.referral_company = '') THEN `tabCustomer`.customer_name\n               ELSE ''\n                END\n LIMIT 10000",
  "status": "Execution Successful",
  "tables": [],
  "title": "Customer List With No Referral Company",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "ps8thnvlon",
  "columns": [],
  "data_source": "Site DB",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.168,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 0,
  "is_native_query": 1,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{}",
  "last_execution": "2024-08-12 10:38:57.507104",
  "limit": 500,
  "modified": "2024-06-19 12:58:01.678133",
  "name": "QRY-0028",
  "result_name": "1lqochuf7f",
  "results_row_count": 1,
  "script": null,
  "script_log": null,
  "sql": "SELECT c.referral_company AS \"Franchise\",\n       CONCAT(DATE_FORMAT(CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 21) DAY, '%d-%m-%Y'), ' to ', DATE_FORMAT(CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 8) DAY, '%d-%m-%Y')) AS \"Last Two Week\",\n       CONCAT(DATE_FORMAT(CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 7) DAY, '%d-%m-%Y'), ' to ', DATE_FORMAT(CURDATE() + INTERVAL (6 - WEEKDAY(CURDATE())) DAY, '%d-%m-%Y')) AS \"This Two Week\",\n       COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL AND tw.customer IS NOT NULL THEN lw.customer END) AS \"Customers Who Bought This Week & Last Week\",\n       COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL THEN lw.customer END) AS \"Customers Who Bought Last Week Only\",\n       CONCAT(ROUND(COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL AND tw.customer IS NOT NULL THEN lw.customer END) / NULLIF(COUNT(DISTINCT CASE WHEN lw.customer IS NOT NULL THEN lw.customer END), 0) * 100, 2), '%') AS \"Retention Rate\"\n  FROM (\n        SELECT DISTINCT name,\n               referral_company\n          FROM `tabCustomer`\n       ) AS c\n  LEFT JOIN (\n        SELECT DISTINCT customer,\n               company\n          FROM `tabSales Invoice`\n         WHERE posting_date >= CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 21) DAY\n           AND posting_date < CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 8) DAY\n       ) AS lw\n    ON c.name = lw.customer\n  LEFT JOIN (\n        SELECT DISTINCT customer,\n               company\n          FROM `tabSales Invoice`\n         WHERE posting_date >= CURDATE() - INTERVAL (WEEKDAY(CURDATE()) + 7) DAY\n           AND posting_date < CURDATE() + INTERVAL (6 - WEEKDAY(CURDATE())) DAY\n       ) AS tw\n    ON c.name = tw.customer\n GROUP BY c.referral_company",
  "status": "Execution Successful",
  "tables": [],
  "title": "Retention Rate SQL Query Franchise Wise(Weekly)",
  "transforms": [],
  "variables": []
 },
 {
  "chart": "v7ldrc6a45",
  "columns": [],
  "data_source": "jibu3",
  "docstatus": 0,
  "doctype": "Insights Query",
  "execution_time": 0.024,
  "filters": "{\n\t\"type\": \"LogicalExpression\",\n\t\"operator\": \"&&\",\n\t\"level\": 1,\n\t\"position\": 1,\n\t\"conditions\": []\n}",
  "is_assisted_query": 1,
  "is_native_query": 0,
  "is_saved_as_table": 1,
  "is_script_query": 0,
  "is_stored": 0,
  "json": "{\n \"calculations\": [],\n \"columns\": [],\n \"dimensions\": [],\n \"filters\": [],\n \"joins\": [],\n \"limit\": 100,\n \"measures\": [],\n \"orders\": [],\n \"table\": {\n  \"label\": null,\n  \"table\": null\n }\n}",
  "last_execution": "2024-08-12 07:31:33.454311",
  "limit": 500,
  "modified": "2024-08-12 07:32:31.866518",
  "name": "QRY-0360",
  "result_name": "v7lf5tsc1q",
  "results_row_count": -1,
  "script": null,
  "script_log": null,
  "sql": "",
  "status": "Execution Successful",
  "tables": [],
  "title": "Query 0360",
  "transforms": [],
  "variables": []
 }
]